spec.md｜云助学 CloudEduMatch（信息对接型公益社交平台）
版本：v1.4（按最新需求修订） 更新时间：2026-01-28 面向对象：产品、研发、运营、安全风控、多校高校节点管理员、志愿者协会（总号/高校分号）、专项援助学校管理方 核心约束：不收现金（不做付费/抽佣/人民币打赏），仅使用积分与学校认可机制（可选）；平台核心是信息对接 + 聊天社交，不是监督学习。

0. 一句话概述
云助学是一个“公益向的社交化信息对接平台”：任何用户都能提出问题与发起交流，通过标签与时间槽匹配到更相似的高校志愿者/老师，主要交付形态为聊天、语音、视频、电话；用积分驱动高质量互动，并为高校提供可配置的治理后台与（可选）认可数据闭环。

0.1 演示数据集（Demo Dataset｜必须可运行）
目的：演示环境必须使用“真实可行的账号群与数据关系”，所有关键链路（跨校审计、高校板块、协会板块、组织账号审核、管理员创建持久化）均应基于数据库与后端 API，而不是仅前端假数据渲染。

演示账号清单（默认密码：123456｜以代码与数据库为准，文档必须与实现一致）
1) 平台治理账号
- superadmin：Platform Super Admin（跨校审计、高校目录、全站底线治理、创建组织/管理员）
- associationHq1：Volunteer Association HQ（跨校审计、审核高校协会入驻申请、发布总公告/全体任务）
2) 高校与组织账号（示例：北京大学 PKU；可扩展南京大学 NJU 等）
- pku_admin：University Admin（治理域=PKU；仅治理 PKU 校级共学社区）
- pku_assoc_admin：University Volunteer Association Admin（治理域=PKU；仅治理 PKU 协会板块、讲师审核、兑换/商城）
- （示例）nju_admin：University Admin（治理域=NJU；由 superadmin 创建/或高校入驻流程生成，必须可登录直达高校板块，不应被重定向到认证中心）
3) 用户层账号（示例）
- student_pku：University Student（school_id=PKU，可进入 PKU 校级共学社区；不可进入协会板块）
- teacher_pku：Volunteer Teacher（school_id=PKU，必须满足：高校学生认证=approved 且 志愿者讲师认证=approved；否则不得显示“讲师”徽标/不得进入匹配池）
- student1：General Student（非高校域用户，仅公共功能）
- （可选）aid_student_1：Special Aid Student（绑定 aid_school_id=ZT1Z，由 zt1z_admin 审核通过后开启专项援助模式）

演示验收要点（最小闭环）
- superadmin 登录后进入“高校目录（跨校审计）”，必须能看到 PKU/THU 等真实高校卡片（学校名称、开通状态、协会账号状态），并可一键进入该校的校级共学社区/志愿者协会板块（审计只读）。
- association_hq 登录后具备同等“高校目录跨校审计”能力；但 association_hq 本身不属于高校，不应生成“协会总号的高校板块”。
- 组织账号申请（高校账号/高校协会账号）若未通过审核，登录后必须停留在审核页（账号已入库但无组织域管理员权限）；通过后升级为对应管理员，并出现在 superadmin 的管理员管理列表中。
- 前端关键页面（公共社区/校内共学社区/高校控制台/协会总号控制台）必须可正常打开与渲染；不得出现语法错误导致构建/启动失败。

演示数据一致性规则（必须满足，否则视为缺陷）
- D1：前端所有“身份徽标/入口显隐/路由分流”必须以 `/auth/me` 返回的 `capabilities + admin_roles + onboarding_status` 为准；不得再以 `user.role === 'xxx'` 的字符串硬编码为准（后端对管理账号统一 role=governance 属正常口径）。
- D2：任意“治理账号（University Admin / University Volunteer Association Admin / Special Aid School Admin）”登录后不得被引导去“学生认证中心”；治理账号的高校/组织治理域必须在 `/auth/me` 中可被解析（见 3.6 / 6.0 / 5.2 的学校域解析规则）。
- D3：展示“讲师”徽标必须同时满足：高校学生认证=approved 且 志愿者讲师认证=approved；两者任一不满足则不得显示“讲师”徽标，也不得出现“可进入协会板块/可接单”等讲师能力。
- D4：University Student 默认不可进入“志愿者协会板块”；该入口仅对“已通过讲师认证”或“协会治理/高校治理账号”开放（见 5.2.4）。
- D5：任何审核/认证列表页必须以数据库与后端 API 为唯一数据源；不得再使用 localStorage 的 `client-store` 作为真实审核队列来源（允许作为 UI 草图/离线原型，但演示环境必须禁用该路径）。
- D6：超级管理员必须具备“账户管理 + 删除”能力；删除为“硬删除（或业务等价硬删除）”，删除后账号不可再登录，且不得再出现在任何列表/筛选视图中（不提供“已停用”页面；必要时仅保留审计日志与历史申请快照）。
- D6.1：任何不可逆/破坏性操作必须二次确认：点击按钮只能打开确认弹窗；仅在显式点击“确认”后才执行；点击取消/遮罩/ESC 必须不执行。破坏性操作包括：账号硬删除、撤销专项援助认证、撤销高校/讲师认证、批量清理高校板块等。
- D6.2：高校板块回收：当某高校的 University Admin（university_admin）管理员账号全部被硬删除后，必须回收/删除该高校的“高校板块（university 组织与入口）”，跨校目录与高校入口不再展示该高校的校级共学社区入口；并自动解除该校已认证学生/讲师的高校域认证（账号保留，不得删除用户账号）。
- D7：演示环境禁止“假数据冒充真实业务”：消息/私聊、公告/公示栏、公共社区、高校校内社区、匹配候选、通知列表等必须以数据库与后端 API 为唯一数据源；严禁展示硬编码示例（如“张老师/自动回复/作者=我/固定通知/本地种子公告”等）作为真实功能。
- D8：认证状态实时一致性：认证中心与全站入口显隐必须以 `/auth/me` 返回的 `profile.verification + capabilities` 为权威；当认证被撤销/失效（例如援助撤销、管理员清理高校板块导致高校域解绑）后，用户前端必须在同一会话周期内刷新 `/auth/me` 并将认证中心状态回退为“未通过/未认证”，不得长期停留在“已通过”的旧 UI。
- D9：匹配闭环必须可运行：匹配结果页必须展示“讲师卡片”（高校名/标签/时间槽/推荐理由等真实字段），学生可对某讲师发起“求助”；讲师端必须收到站内通知并在首页看到“待响应求助”；讲师接受/拒绝后双方均收到通知；接受后自动建立私聊会话并可继续通过消息联系。
- D10：消息未读必须可用：通知必须区分已读/未读并提供“未读总数”；会话必须支持已读游标并可计算未读；前端 Navbar 的“消息/通知”按钮旁必须展示实时未读角标；消息页“会话/通知”Tab 必须展示对应未读角标，其中“会话未读”按“存在未读消息的会话个数”计数。
- D11：社区发帖与论坛楼层必须可运行：公共社区与校内社区发帖后必须在列表中可见（刷新后仍可见），且每条帖子可进入“帖子详情页”以论坛开楼形式展示楼层评论；支持发表评论并即时可见，评论数同步更新；高校/协会治理后台的帖子列表必须读取真实后端数据（不得再使用 localStorage 的 client-store 作为真实帖子来源）。公示栏/公告列表同样必须读取真实后端数据（不得再用 localStorage 或前端种子公告）。同时必须避免“列表有数据但页面空白”的情况（例如动画/视口判定导致卡片长期透明），并确保前端 API 通过同源代理访问后端以适配非 localhost 访问场景；当请求失败/网络抖动/后端重载时，列表不得被清空为“空白页”，必须保留最近一次成功加载的数据并提示可重试；当用户访问到不存在的帖子详情时，页面必须展示明确空态并避免无意义的控制台错误干扰排查；当高校治理后台对帖子执行隐藏/置顶/删除时，如果帖子已不存在或校域不匹配，必须提示并刷新列表，不允许抛出未捕获异常影响使用。
- D12：首页“最近的辅导”必须数据化：该模块必须展示真实会话（匹配接单后建立的私聊会话优先），并可一键进入会话；不得再展示硬编码的“最近辅导示例卡片”。

1. 背景与问题定义
1.1 核心问题
1.需求侧“想问/想聊”但找不到更匹配的人：缺少结构化表达与可信候选池。
2.信任与安全：公益服务涉及未成年人、陌生人沟通，需要可信身份、风控、投诉仲裁。
3.供需匹配效率低：标签不统一、时间不对齐、沟通成本高、难沉淀关系。
4.多校治理难：多所高校参与，需“统一平台能力 + 分校可配置规则 + 数据隔离与导出”。
1.2 平台定位
核心定位：信息对接与交流平台（社交 + 咨询匹配）。
核心亮点：不组织大规模线下教学，不做学习监督；重点做“对接-沟通-关系沉淀”。
核心机制：积分驱动 + 高校认证供给侧 + 分校治理模板 +（可选）学校认可闭环。
核心场景：公益咨询与陪伴交流（学业、升学经验、技能、生活经验、心理陪伴等“标签化需求”）。
1.3 非目标（Out of Scope）
不做作业批改、考试系统、上课监管、学习打卡考核。
不引入现金交易/提现/人民币打赏/付费课程。
不承诺替代学校教学体系或输出成绩提升保证。

2. 产品目标与成功标准
2.1 产品目标（Must）
1.建立可持续的社交化信息对接网络：用户更快找到“更匹配的人并聊起来”。
2.积分经济驱动供需双方贡献与履约（无现金）。
3.支持多高校接入：统一平台、分校治理与数据隔离。
4.对需要“学校认可”的场景提供可信服务闭环（可选能力，不改变平台主定位）。
2.2 北极星指标（North Star）
有效对接数/日（或/周）：完成一次“匹配/发起交流 → 会话/通话发生 → 双方至少一方评价/反馈”的闭环。
2.3 核心指标（KPI）
匹配：匹配请求数、候选点击率、对接发起率、首响时长、对接完成率
问答：提问解决率、采纳率、平均响应时长
社交：7日/30日留存、会话数/人、群活跃度
高校板块：校内DAU、跨校DAU、活动/项目数、资源贡献数
质量与安全：投诉率、举报率、严重事件率、处置时效、复约率
积分：流通率、通胀/滥发风险、异常交易拦截率

3. 用户体系与角色（最终讨论版｜按组织分层治理）
3.1 角色定义（管理层 vs 用户层）
管理层（Governance）
Platform Super Admin（超级管理员/开发者账号）：平台技术与全站治理底座，负责系统健康监控、紧急事件处置（故障/攻击/重大违规）、全站风控与封禁、全站内容底线治理、标签字典维护；默认不参与“高校/协会日常审核链路”，仅在早期/兜底场景介入（见 3.3）；可查看并进入所有“已认证/已入驻”的高校板块（跨校审计视角）。
Volunteer Association HQ（志愿者协会总号）：全国/总会级治理主体；发布总公告与全体任务（例如政府/公益机构统一任务）；监控并审核各高校志愿者协会的活动与执行情况；审核高校志愿者协会的成立/入驻申请；可对分会做风控建议与升级处置申请；可查看并进入所有“已认证/已入驻”的高校板块（跨校审计视角）。
University Admin（高校账号｜校级共学社区负责人）：负责本校高校板块“校级共学社区”治理（话题、帖子、群、校内资源精选、校内秩序）；配合高校统一身份认证接入与校内用户治理。
University Volunteer Association Admin（高校志愿者协会账号）：负责本校志愿者讲师的认证审核与管理；仅在“高校→志愿者协会板块”发布专项任务/紧急对接与公告；配置本校积分兑换机制与“校内协会商城”；可选择将公告同步到全站社区公示栏。高校账号（University Admin）为本校高校板块最高管理层，可向“校级共学社区/志愿者协会板块”发布公告。
Special Aid School Admin（专项援助学校管理账号）：经“志愿者协会总号”认定的入驻学校管理方；负责专项援助学校/受助学校侧的认证审核（含批量/名单校验）；认证通过的学生可开启“专项援助模式”；可对本校专项援助群体的合规与安全负责并配合风控抽检。

用户层（Users）
Guest（游客用户）：未完成任何认证的普通用户；可浏览公共内容、发帖/提问（限频/限额）。
General Student（普通学生）：非高校学生或高校未认证用户；可走“基础学校信息+证明材料”认证路径（早期由平台审核，成熟后移交入驻学校/专项援助学校管理方）。
University Student（普通高校学生）：完成“高校统一身份认证/高校认证”的高校学生；可进入对应高校板块，并使用“校级共学社区”。
Volunteer Teacher（志愿者讲师）：供给侧角色；需完成高校身份认证，并通过“本校高校志愿者协会账号”审核后进入匹配池提供服务；其服务行为受平台风控与协会/高校双治理。
Special Aid Student（专项援助学生）：在“专项援助学校管理账号”认证通过的学生群体；在匹配、私聊、通话等功能上可启用更严格默认安全策略与更明确的对接范围（例如优先对接志愿者讲师池）。

3.2 关键原则（落地约束）
1.需求侧不限身份：任何人都可以“问问题/寻求交流/发帖”，但受配额、限频与风控门槛约束。
2.不收现金：所有激励与交换以积分为主；志愿时长与学校认可为可选“组织侧认可机制”，不改变平台主定位。
3.多主体治理：平台提供统一底线 + 多租户隔离；高校/协会在自己的域内配置规则并对外呈现一致的解释口径。
4.职责不混淆：超级管理员负责全站底线与系统健康；协会总号负责“协会体系治理”；高校账号负责“校级共学社区”；高校志愿者协会账号负责“志愿者讲师与校内兑换/任务”。
5.标签义务分层：
o需求侧：不强制在个人资料中完善标签；但在“发起匹配/发布悬赏问题”时需选择需求标签（至少1个）。
o供给侧（志愿者讲师）：必须提供若干有效标签与时间槽（默认≥5，可配置），否则不可进入匹配池。

3.3 认证与审核（修订版｜按不同认证独立进行，不要求步骤化）
认证中心以“独立认证项”呈现，用户按自身需求选择提交，不做统一的强制步骤链路；但存在“业务前置条件”（例如：志愿者讲师需先完成高校身份认证）。
注册规范：个人注册仅创建普通用户身份（general_student/guest）；不得在注册页直接选择“志愿者讲师/高校学生”等需审核的身份。若希望获得高校学生认证或讲师能力，必须在认证中心提交材料并等待审核通过后生效。
高校学生认证（University Student）
o方式：优先接入高校统一身份认证（SSO/学籍系统/统一认证），或由 University Admin 进行校内身份核验。
o结果：获得高校身份徽章与进入高校板块权限（仅限本校）。
志愿者讲师认证（Volunteer Teacher）
o审核主体：University Volunteer Association Admin（本校志愿者协会账号）。
o要求：高校身份已确认 + 资质材料/培训证明/服务意愿 + 标签与时间槽完整性校验。
o平台侧（Platform Super Admin）仅做风控兜底：可冻结、下架、封禁；不作为日常审核链路的一环。
普通用户基础认证（General Student / 普通用户补充学校信息）
o内容：学校信息、基础证明材料（最小化采集，满足风控与信任底线）。
o早期审核：Platform Super Admin 审核（过渡期）；后续可移交“入驻学校/专项援助学校管理方”审核。
专项援助学生认证（Special Aid Student）
o审核主体：Special Aid School Admin（经协会总号认定）。
o能力：支持班级/年级/名单批量认证与批次管理，降低逐个审核成本。
高校志愿者协会入驻/成立申请
o审核主体：Volunteer Association HQ（志愿者协会总号）。
o结果：批准后可开通高校志愿者协会账号与对应的“高校志愿者协会板块”治理权限。

3.3.1 审核/认证数据体系（后端统一队列｜必须）
统一原则：所有审核类事项必须落库，并以统一队列模型对外提供查询与审批；前端页面仅渲染后端返回的数据，不得再自产“待审核假数据”。
认证申请队列：VerificationRequest（verifications）
o字段：type、applicant_id/applicant_name、target_school_id、target_organization_id、evidence_refs、note、status、reviewed_by/reviewed_at/rejected_reason。
o列表端点：/association/verifications/requests（按角色强制过滤；HQ/超管可跨域）
o审批端点：/association/verifications/requests/{id}/review（按角色校域/组织域校验）
组织入驻队列：AdminOnboardingRequest（onboarding）
o字段：org_type、school_name、association_name、contact_xxx、evidence_refs、status、reviewed_xxx。
o列表端点：/admin/onboarding-requests（仅 HQ/超管）
o审批端点：/admin/onboarding-requests/{id}/review（通过后授予管理员权限并创建/复用组织域）

3.3.1.1 材料存储与预览（必须｜解决“审核材料打不开”）
统一原则：审核材料必须可被“申请人本人 + 可审核角色 + superadmin/HQ”在线查看或下载；不得仅展示文件名占位。
上传端点：/files/upload（返回 file_id + url + name + mime + size）
访问端点：/files/{file_id}（强制鉴权，按申请归属授权；支持浏览器直开/下载）
evidence_refs 格式：JSON 数组；元素为文件对象或 URL（推荐文件对象：{id,name,url,mime,size}）
前端审核列表必须提供“打开材料/下载材料”入口；并提供“查看申请人信息”入口（按 applicant_id 拉取用户快照：email/学校/角色/认证状态）。

审核矩阵（必须按此口径实现）
高校学生认证（type=university_student）
o创建者：普通用户/普通学生（提交学校选择 + 材料）
o目标字段：target_school_id=school_id（禁止用中文名字符串替代）
o可见/可审：university_admin（仅本校）、HQ、superadmin（兜底）
o审批回写：approved → applicant.role=university_student，applicant.school_id=target_school_id；profile.verification.student=verified
志愿者讲师认证（type=volunteer_teacher）
o前置条件：高校学生认证已 approved（且 applicant.school_id 已绑定）
o硬约束（见 3.3.2）：target_school_id 必须等于 applicant.school_id；target_organization_id 必须等于该 school_id 对应的 university_association 组织
o可见/可审：university_association_admin（仅本校）、HQ、superadmin（兜底）
o审批回写：approved → applicant.role=volunteer_teacher（保留 school_id）；profile.verification.teacher=verified
专项援助学生认证（type=special_aid）
o创建者：普通用户/学生（选择受援学校 + 材料）
o目标字段：target_school_id=aid_school_id（受援学校域标识）
o可见/可审：aid_school_admin（仅本校）、HQ、superadmin（兜底）
o审批回写：approved → applicant.role=special_aid_student；applicant.school_id=target_school_id；profile.verification.aid=verified
普通用户基础认证（type=general_basic）
o过渡期审核：superadmin 或 HQ（成熟后可移交到入驻学校/专项援助学校管理方）
o审批回写：profile.verification.generalBasic=verified/rejected

3.3.2 志愿者讲师“只能申请本校协会”规则（必须｜对应需求3）
定义：高校认证学生想成为志愿者讲师，只能向其绑定高校的“高校志愿者协会账号”发起申请。
前端约束（强制）
o当用户高校学生认证=approved 时，讲师申请的学校选择必须锁定为用户 school_id；组织选择必须自动绑定为该 school_id 的 university_association 组织；不得允许跨校选择。
后端约束（强制）
o创建志愿者讲师申请时：若 applicant.school_id 为空或与 target_school_id 不一致 → 直接拒绝（400/403）。
o若 target_organization_id 不属于该 school_id 的 university_association 组织 → 直接拒绝（400）。

3.4 组织关系与账号开通（多租户治理）
组织类型与绑定关系
association_hq（志愿者协会总号）：全站唯一（或少量），不绑定 school_id；负责协会体系治理。
university（高校）：绑定 school_id；对应“高校账号（University Admin）”的治理域（校级共学社区）。
university_association（高校志愿者协会）：绑定 school_id；对应“高校志愿者协会账号（University Volunteer Association Admin）”的治理域（协会板块/讲师池/校内兑换与时长）。
aid_school（专项援助学校）：绑定 aid_school_id；对应“专项援助学校管理账号（Special Aid School Admin）”的治理域（专项援助学生认证/批次/安全策略）。

3.4.1 school_id 规范与唯一性（必须｜解决“同名高校板块重复/管理员绑定错误”）
定义
school_id：高校域唯一规范标识，用于隔离校内数据、审核队列与组织域绑定；必须稳定、可复用且不随展示名变化。
display_name：高校展示名（中文），仅用于 UI 展示与搜索命中。
规范
演示环境允许两种口径其一（但必须全链路一致）：
o口径A：采用高校缩写（PKU/THU/NJU 等）作为 school_id（推荐）
o口径B：统一派生码（例如 UNI_xxxxxxxx），由后端对“规范化后的高校名”派生（必须提供 name_normalization 规则）
唯一性约束（强制）
对高校相关组织必须满足：UNIQUE(type, school_id)（同一高校最多一个 university + 一个 university_association）
建议额外满足：UNIQUE(type, display_name)（默认高校中文名唯一；若允许重名需明确例外与 disambiguation 规则）
前端展示约束
高校目录/认证下拉必须展示 display_name；选择/提交必须携带 school_id（不得用中文名字符串替代 school_id）。

3.4.2 组织创建/复用规则（必须｜避免重复创建同名高校）
统一原则：任何入口创建组织域时必须“先复用后创建”，并确保新管理员绑定到既有组织域。
复用优先级（university / university_association）
o优先按 (type, school_id) 查找复用（强制）
o其次按 (type, display_name) 兜底复用（用于历史数据兼容）
o均不存在才创建新 Organization
入驻审核通过/超管创建组织/超管创建管理员三个入口必须使用同一套 get_or_create 逻辑，不得各写各的。
出现历史重复数据时：必须先做数据去重迁移（更新引用表的 school_id → canonical school_id）再启用数据库唯一索引。

账号开通原则（谁审批谁）
高校志愿者协会账号：由高校提交成立/入驻申请 → 志愿者协会总号审核通过 → 平台开通账号与治理域。
专项援助学校管理账号：由学校提交入驻申请 → 志愿者协会总号认定通过 → 平台开通账号与治理域。
高校账号（University Admin）：由高校入驻/对接高校统一认证后开通；默认由平台开通并绑定 school_id（后续可扩展为高校自助申请+校验）。

角色叠加与优先级（同一用户可具备多身份）
用户层身份可叠加：例如“University Student + Volunteer Teacher”“General Student + Special Aid Student”。
治理权限不可越域：任何管理账号只能在绑定的组织域内生效（除 Platform Super Admin 与协会总号）。
展示与能力以“最强身份”生效：进入功能模块时按前置条件判定；例如具备 Volunteer Teacher 才能进入“高校→志愿者协会板块”的讲师管理能力。

3.5 职责边界（可检查规则｜避免职能混乱）
R1：志愿者讲师认证审核只归属高校志愿者协会账号；Platform Super Admin 不做日常审核，仅做风控处置与兜底复核。
R2：高校志愿者协会成立/入驻申请只归属志愿者协会总号审核；高校账号与 Platform Super Admin 不直接批准成立（平台仅负责开通与风控底线）。
R3：高校校级共学社区治理（话题/帖子/资源精选/群）只归属高校账号；高校志愿者协会账号仅治理协会板块，不越权管理校级共学社区内容。
R4：协会总号只发布“总公告/全体任务”，并监控审核各高校协会活动；高校协会账号发布本校公告/本校专项任务，可选择同步到全站公示栏。
R4.1：高校志愿者协会账号不得在“校级共学社区”发布公告/任务，也不得发布面向“本校高校板块全体（campus_all）”的校内公告；其校内公告默认仅面向“本校已认证讲师（association_teachers_only）”。
R4.2：高校账号为本校高校板块最高管理层：可在“校级共学社区”发布校内公告，也可发布面向“本校已认证讲师”的公告（在志愿者协会板块中可见，并带来源标识）。
R5：普通用户基础认证在过渡期由 Platform Super Admin 审核；一旦某学校成为“专项援助学校/入驻学校”，该校相关群体的认证应移交对应学校管理账号审核。
R6：系统监控与紧急事件响应（故障/攻击）只归属 Platform Super Admin；高校/协会账号不直接处理系统级事件，仅可上报。
R7：任何涉及志愿时长的发放/兑换/回滚必须可审计：记录来源、批准人、规则版本与证据材料（见 6.7 与附录字段字典）。

3.6 能力字段与学校域解析（实现口径｜解决“治理账号跳认证中心/学生误入协会板块”等问题）
统一原则：治理权限与功能入口必须以 `/auth/me` 的 `capabilities + admin_roles + onboarding_status` 为准；不得依赖 `role` 字符串做硬编码判断（治理账号后端统一 role=governance 属正常）。
/auth/me 关键字段（MVP必须返回）
o onboarding_status：pending/approved/rejected（决定登录后落地页）
o capabilities：can_access_admin_panel、can_access_campus、can_access_association、can_manage_university、can_manage_association、can_manage_aid、can_manage_platform、can_audit_cross_campus、role_display
o admin_roles：[{ role_code, organization_id }]（role_code 用于精确判定治理身份；organization_id 用于确定治理域）
o school_id：用于高校域/校内数据隔离的唯一标识（例如 PKU/THU/NJU）；必须确保治理账号也能解析出其 school_id（见下）
学校域解析规则（必须）
o 若用户具备 admin_roles.role_code ∈ { university_admin, university_association_admin }：则其“治理域 school_id”必须可被解析，且前端不得因为“未提交高校学生认证”而将其重定向到认证中心。
  - 推荐实现：后端直接在 /auth/me 返回 school_id（即治理域的 school_id）
  - 允许备选：/auth/me 返回 organization_id，前端再调用组织元信息接口解析出 school_id（但必须保证首屏不闪跳/不误重定向）
o 若用户具备 admin_roles.role_code = association_hq：其 school_id 可以为 null（因为不绑定高校），但必须具备 can_audit_cross_campus=true，并可进入“高校目录（跨校审计）”选择任意高校进入只读审计视角。
前端入口显隐口径（必须）
o 顶部“高校”入口：capabilities.can_access_campus == true 或 capabilities.can_audit_cross_campus == true 时显示
o “志愿者协会板块”入口（用户侧）：仅当
  - capabilities.can_access_association == true（通常意味着志愿者讲师认证 approved），或
  - capabilities.can_manage_association / can_manage_university / can_audit_cross_campus == true（治理/审计身份）
  否则必须显示“需完成讲师认证/协会认证”的前置提示，并跳转到认证中心对应卡片。
o “讲师”徽标：仅当（高校学生认证=approved 且 志愿者讲师认证=approved）；不得仅凭 role=volunteer_teacher 显示。

3.6.1 前端 Hooks 工程约束（必须｜避免“页面打不开/Rendered fewer hooks”）
所有 React hooks（useState/useEffect/useMemo/useCallback/useContext 等）必须在组件顶层无条件调用；同一组件的每次渲染 hooks 顺序与数量必须一致。
禁止在组件中途提前 return 后仍存在 hooks（例如先 return null，再在下方调用 useMemo），否则会触发 “Rendered fewer/more hooks than expected / Hooks order changed”。
推荐结构：外层组件仅负责鉴权与 redirect（可早返回），内层纯展示组件不做鉴权分支；或将所有 useMemo 上移，并在依赖缺失时返回安全默认值。

3.6.2 超级管理员账户管理与删除（必须｜对应需求2/5/6/7）
目标：提供可运行的“账户管理”能力，覆盖所有账号（用户层 + 治理层），并支持硬删除与分类浏览；并保证删除后全站实时一致。
账户管理界面（superadmin 控制台）
o支持按类别筛选：治理账号（按 admin_roles.role_code）、普通用户（general_student/university_student/volunteer_teacher/special_aid_student）、游客、已停用。
o对治理账号必须展示其“管理域标识”：组织 display_name + school_id/aid_school_id（便于核对是否绑定正确高校/学校）。
删除语义（演示环境默认=硬删除）
o删除为“硬删除（或业务等价硬删除）”：账号不可再登录；且不得再出现在任何列表/筛选视图中（不展示“已停用”占位数据）。
o硬删除必须级联清理：认证申请、入驻申请、讲师池条目、匹配请求、文件材料记录等；不得留下“空壳条目”导致列表异常（见 D6、D6.2 与 15.10）。
o仅在必要审计场景保留最小化审计日志/快照（不影响任何业务列表的可见性）。
o禁止删除：当前登录的 superadmin 自身、以及“最后一个超级管理员”（防止系统锁死）。

4. 权限矩阵与配额（必须可配置）
4.1 权限矩阵（分层表达）
用户层（核心功能）
功能模块	游客用户	普通学生	普通高校学生	志愿者讲师	专项援助学生
浏览公共内容（社区/问答/知识库）	✅	✅	✅	✅	✅
发布公共帖子/评论/互动	✅（限频）	✅	✅	✅	✅（更严格默认安全）
悬赏提问（积分）	✅（低额度/低次数）	✅（中）	✅（更高）	✅	✅（受限/更严格风控）
回答问题	✅（低信用限制）	✅	✅	✅（权重更高）	✅
快速匹配（找人）	✅（少量）	✅	✅（更多）	✅（接单/被推荐）	✅（更严格门槛与默认策略）
私聊IM（文字/图片/表情）	✅（陌生人限频）	✅	✅	✅	✅（更严格陌生人门槛）
语音/视频通话	⚠️（风控门槛）	⚠️（分层开放）	✅	✅	⚠️（更严格分层开放）
高校板块（本校）	❌	❌	✅	✅	❌
高校志愿者协会板块（本校）	❌	❌	⚠️（需协会认证）	✅	❌
知识库上传资源	✅（严格审核）	✅	✅（可见本校专区）	✅（更高权重）	✅（更严格审核）
服务单（预约/确认/评价/结算）	⚠️（受限）	✅	✅	✅	⚠️（更严格风控与默认安全）
积分账户（钱包）	✅（起始较少）	✅（起始中）	✅（起始更多）	✅（起始更多）	✅（起始与规则由专项援助方配置）
个人中心装扮兑换（勋章/称号等）	✅	✅	✅	✅	✅

管理层（治理与配置）
Platform Super Admin：系统监控（实时活动分“日常/紧急”）、全站风控与内容底线、标签字典；不负责高校/协会活动申请审核；不负责志愿者讲师日常认证审核；早期可代审“普通用户基础认证”作为过渡方案。
Volunteer Association HQ：发布总公告与全体任务；审核高校志愿者协会成立/入驻；审核与监控各高校协会活动；对违规/异常协会发起治理升级。
University Admin：管理“校级共学社区”（话题/帖子/资源/群），维护校内秩序；协同接入高校统一身份认证。
University Volunteer Association Admin：管理本校志愿者讲师认证与运营数据；发布专项任务/紧急对接与公告；配置本校积分兑换机制与“校内协会商城”；可选同步公告到全站公示栏。
Special Aid School Admin：管理专项援助学校的认证申请与批次；认证通过后开启专项援助模式；配合平台与协会总号的风控抽检。
所有配额、门槛、阈值均需后台可配置（按运营/风控动态调参）。默认值仅作为MVP建议。
4.2 默认配额建议（可配置｜示例）
游客用户（Guest）
o每日快速匹配：≤ 3
o每日悬赏提问：≤ 1（低悬赏上限）
o陌生人私聊：限频（如每日 ≤ 20 条或每小时 ≤ 3 条）
o语音/视频：需通过实名/风控评估分层开放
o起始积分：较少（限制大额悬赏/高频匹配）
普通学生（General Student）
o每日快速匹配：≤ 5~8
o每日悬赏提问：≤ 2~3
o语音/视频：分层开放
o起始积分：中等
普通高校学生（University Student）
o每日快速匹配：≤ 10
o每日悬赏提问：≤ 5
o高校板块：可用（本校）
o起始积分：高于游客
志愿者讲师（Volunteer Teacher）
o每日可接单/咨询：按信用分动态（如 5~20）
o可计入学校认可：需满足本校规则（完成服务单、评价、无投诉等）
o可配置：校内兑换机制与协会商城（由高校志愿者协会账号配置）
专项援助学生（Special Aid Student）
o默认更严格安全策略：陌生人私聊/通话更高门槛；匹配优先推荐志愿者讲师
o配额建议：匹配/提问次数可适当提高，但需更严格风控与对接范围约束
4.3 风控门槛（关键策略）
新号/低信用：限频、限制外链、限制引导站外联系、限制深夜通话
高风险行为（多次举报/疑似营销/骚扰）：逐级限制（禁言→限制私信→限制通话→封禁）
高校板块反引流：招募/合作信息必须模板化（描述范围、时间、责任、站内联系）

4.4 默认安全策略（按用户类型差异化｜Safe-by-default）
说明：该策略为默认建议，最终以“全站风控配置 + 组织域规则”共同生效；专项援助学生默认更严格。
游客用户（Guest）
o陌生人私聊：强限频；默认禁止发送外链/二维码/站外联系方式
o语音/视频：默认关闭，需通过基础实名/风控评分后分层开放
o文件/图片：允许图片，限制文件与敏感格式；敏感内容提示与折叠
普通学生（General Student）
o陌生人私聊：限频；仍限制外链与站外引导
o语音/视频：分层开放（与实名、信用、举报历史联动）
o对接范围：默认不进入高校板块；匹配优先推荐“志愿者讲师”而非陌生高校学生
普通高校学生（University Student）
o校内互动：校级共学社区内放宽互动频率（仍受全站底线）
o跨校/站外引导：更严格反广告；招募信息需模板化
o语音/视频：允许，但对陌生人通话仍受风控门槛与深夜限制
志愿者讲师（Volunteer Teacher）
o供给侧保护：对接频次与可接单数按信用动态；异常行为触发降权与下架
o通话能力：可用；通话前安全提示；通话后强制评价入口（用于风控与质量分）
o资料发送：可发送必要的学习资料，但仍禁止站外引流与敏感信息收集
专项援助学生（Special Aid Student）
o默认更严格：陌生人私聊更高门槛；通话默认关闭或更高阈值；敏感词与外链更严格拦截
o对接优先级：默认优先推荐“志愿者讲师池”；禁止被普通陌生用户主动发起通话
o组织域可配置：由专项援助学校管理方配置更细规则（例如可对接时间窗、允许的沟通方式）

5. 信息架构（IA）与导航（含高校板块）
5.1 顶部主导航（Web）
首页（推荐/快捷入口）
匹配（找人/立即聊/预约）
问答（悬赏池/回答/我的问题）
社区（话题广场/动态/公示栏）
知识库（资源/笔记/精选）
高校（高校相关角色可见：进入高校板块；超级管理员/协会总号可跨校查看已认证高校板块）
消息（私信/群聊/通话/系统通知）
我的（认证中心/积分/积分商城/成就/隐私/历史/收藏/设置）
5.2 高校板块二级导航（高校域）
适用角色
默认进入本校：University Student / Volunteer Teacher / University Admin / University Volunteer Association Admin
跨校审计进入：Platform Super Admin / Volunteer Association HQ（仅可进入“已认证/已入驻”高校板块；默认只读与审计，不做日常治理操作）
跨校入口形态（必须）
为 Platform Super Admin / Volunteer Association HQ 提供“高校目录页（跨校审计）”：上方保留搜索（typeahead / 关键词搜索），下方以“一个高校一个卡片/一行”的方式排布已认证高校板块；每张卡片显示高校名称、开通状态、协会账号状态与快速入口（校级共学社区 / 志愿者协会板块）。
高校目录页必须同时具备：搜索过滤 + 可视化卡片排布 + 一键进入某校高校板块（审计模式只读）。
搜索交互要求：当搜索候选/下拉列表超过可视高度时，必须可用鼠标滚轮在候选列表内滚动，且在弹窗/模态（例如认证中心）场景下滚轮不得被锁滚层吞掉导致“无法滚动”。
实时一致性：当高校板块被回收或账号被硬删除后，高校目录与认证中心的检索/下拉必须在短时间内反映最新状态（允许轮询/刷新，但不得长期展示已删除高校/账号）。
“已认证/已入驻高校板块”判定：按 school_id 聚合组织域，至少满足其一：
o（1）存在 university 类型 Organization（高校组织域已开通）
o（2）存在 university_association 类型 Organization（该校高校志愿者协会组织域已开通）
平台可按运营配置进一步收敛为“完成入驻审核且开启高校板块”。高校目录不得把 association_hq 当作高校组织域，也不得生成“协会总号的高校板块”。高校目录建议由后端聚合接口直接提供（避免前端自拼导致口径不一致）。
二级导航
校级共学社区（本校）：所有本校高校学生可用，由 University Admin 治理
志愿者协会板块（本校）：需通过高校志愿者协会认证（讲师认证通过），由 University Volunteer Association Admin 治理；本板块内包含“校内协会商城/兑换规则/时长结算”的用户侧入口（可见性按角色/认证分层）
本校公告：高校账号/高校志愿者协会账号可按“组织域+人群”发布（见 6.8.1）；可选同步至全站社区公示栏
5.3 管理端入口（按角色显隐）
超级管理员控制台（Platform Super Admin）：系统监控（日常/紧急）、全站风控与处置、标签字典、全站公告、过渡期基础认证审核
志愿者协会总号控制台（Volunteer Association HQ）：总公告/全体任务、协会入驻申请审核、高校协会活动审核与监控
高校账号控制台（University Admin）：校级共学社区治理、校内资源/话题/帖子管理
高校志愿者协会控制台（University Volunteer Association Admin）：志愿者讲师审核/管理/数据、专项任务、公告、校内协会商城与兑换规则
专项援助学校管理端（Special Aid School Admin）：专项援助认证审核（含批次）、名单管理、对接安全配置

5.4 管理端信息架构（页面清单｜MVP 可开工粒度）
说明：以下为“菜单 → 页面目标 → 关键操作/字段”的建议清单；实际可按迭代拆分上线。

5.4.1 超级管理员控制台（Platform Super Admin）
系统监控
实时活动（分组：日常/紧急）：日常用于运营观测；紧急为红色告警（系统故障/攻击/重大异常）。
o字段：时间、级别、来源（系统/风控/告警）、事件标题、详情、影响范围、处理状态、处理人、关联工单ID
o操作：确认/升级/关闭、创建工单、广播系统通知（可选）
系统健康：服务状态、错误率、延迟、告警规则（占位）
跨校审计（只读）
高校板块总览：查看所有已认证/已入驻高校列表（school_id、名称、开通状态、协会账号状态、近期公告/任务摘要），支持“一键进入该校高校板块”做抽检与风控复核
全站治理（底线）
举报与处置：举报列表、工单流转、禁言/封禁/下架、申诉复核
风控策略：限频阈值、外链策略、通话门槛、深夜限制（配置占位）
全站配置
标签字典（Tag）：增删改、启用停用、分类管理
全站公告：平台公告发布、置顶、版本追溯
过渡期审核（仅早期）
普通用户基础认证审核：申请列表、材料查看、通过/驳回、审计记录
明确不包含
不审核高校/协会活动申请；不做志愿者讲师日常认证；不做高校学生日常认证（除系统性兜底或过渡期方案）

5.4.2 志愿者协会总号控制台（Volunteer Association HQ）
公告与任务
总公告管理：发布面向全体的总公告（可进入社区公示栏）
全体任务管理：发布全体任务（政府/公益机构统一任务），设置参与范围与考核口径
跨校审计与治理（必须）
高校板块总览：查看所有已认证/已入驻高校板块并进入，抽检校内公告/任务/讲师池健康度
协会入驻与治理
高校协会成立/入驻申请：申请列表、材料查看、通过/驳回、开通组织域
高校协会活动审核与监控：对高校协会活动进行审核/抽检/评分
o字段：高校、活动名称、类型、影响范围、时间、负责人、风险等级、审核状态、执行进度、异常标记
协会治理：对违规/异常高校协会发起整改、暂停、移交平台风控
数据看板（占位）
高校协会活跃、任务完成率、投诉率、严重事件率、处置时效

5.4.3 高校账号控制台（University Admin）
校级共学社区治理
帖子管理：列表、置顶/下架、违规处理、评论管理
话题管理：创建/合并/停用、推荐位
公告发布（高校最高管理层）
o校级共学社区公告：面向本校高校板块可见（默认）
o志愿者协会板块公告：可面向“本校已认证讲师”发布公告（默认仅该人群可见），用于校内志愿组织运行与培训安排
o可选同步至全站公示栏：高校公告同步全站需满足反引流与敏感信息校验
校内资源精选：对知识库资源打“本校精选”、分区展示
用户与群（占位）
校内群组治理：群管理、成员异常处理
高校学生身份核验（兜底）：当未接入 SSO 时提供人工核验队列
数据看板（占位）
校内DAU、发帖/评论、资源贡献、举报/处置时效

5.4.4 高校志愿者协会控制台（University Volunteer Association Admin）
讲师审核与管理（核心）
讲师认证审核：申请列表、材料查看、标签/时间槽校验、通过/驳回、黑名单
讲师管理：实时数据（服务单、响应时长、评价、投诉）、下架/冻结、风险标记
专项任务与时长
专项任务管理：创建/发布/结束、参与名单、证据与核验、时长结算记录
时长发放/回滚：发放来源（任务/兑换/补发）、审核人、规则版本、证据附件
公告
协会公告：发布本校公告；默认仅“本校已认证讲师 + 本校协会管理人员”可见；支持“同步到全站社区公示栏”开关与置顶（同步需过反引流校验）
校内协会商城与兑换机制
兑换规则配置：积分↔时长比例、周期上限、冷却期、门槛（信用/投诉/评价）
校内协会商城：商品上架、兑换库存、兑换记录与导出
数据看板（占位）
讲师供给活跃、服务完成率、投诉率、兑换异常率

5.4.5 专项援助学校管理端（Special Aid School Admin）
专项援助认证（核心）
认证批次管理：批次创建、名单导入、批量通过/驳回、变更追溯
单个认证审核：材料查看、通过/驳回、驳回原因模板
安全与对接配置
专项援助模式配置：允许的沟通方式、可对接时间窗、白名单/黑名单、通话门槛
数据看板（占位）
专项援助学生对接数、投诉率、严重事件、处置时效

6. 核心功能模块（全站协调版）
平台主干是“IM/通话 + 匹配”；问答与社区用于流量与关系沉淀；知识库提供长期价值；高校板块用于校内协作与跨校共建。

6.0 认证中心（产品形态｜独立认证项，不要求步骤化）
产品形态
入口：我的 → 认证中心；以及高校/志愿者协会板块的“前置条件提示”入口。
展示：以卡片列出可用认证项（高校学生认证、志愿者讲师认证、普通用户基础认证、专项援助学生认证），每项独立展示状态与可执行动作。
状态：none（未提交）/ pending（审核中）/ approved（已通过）/ rejected（已驳回，可重提）。
通用能力：查看提交记录与审核意见；驳回后可修改材料再次提交；所有审核动作需记录审计日志（谁在何时基于何规则版本通过/驳回）。

组织选择与搜索（关键交互）
认证表单中的“组织/学校/协会”字段必须支持搜索下拉（typeahead）。
候选源：平台已入驻/已认证的组织清单（高校、该校高校志愿者协会、专项援助学校）。
示例：申请“北京大学志愿者协会”的志愿者讲师认证时，搜索框输入“北京大学”即可出现“北京大学志愿者协会”候选项，点击后自动填入组织域并绑定对应 school_id。
展示口径（必须｜修复“下拉里只有『已入驻高校』而没有学校名”的问题）
o 候选项主标题必须为组织/学校的中文名称（display_name），例如“北京大学”“南京大学”“北京大学志愿者协会”
o “已入驻/已认证/审核中”等状态只能作为 Badge/副标题展示，不得作为主标题替代学校名
o 候选项必须携带可检索的 keywords（例如中文名/英文缩写/校名别称），保证输入“北大/PKU/北京大学”均可命中
空结果处理：若无匹配项，允许“手动填写 + 提交材料”，进入人工核验/补全流程（由对应审核主体决定是否接受）。
安全约束：组织候选项必须是“已认证/已入驻”的组织；不允许用户自造组织名绕过组织域隔离。

认证项A：高校学生认证（University Student）
触发：进入“高校板块”前置；或在认证中心主动提交。
前置条件：无。
提交字段（建议）
o学校：school_id（必填）
o身份校验：优先 SSO/统一认证凭证（token/回调凭证）；如无 SSO，提交学生证/在读证明（图片/PDF）
o基础信息：真实姓名（可选，最小化采集）、学号/工号（可选，取决于校验方式）
审核主体
o优先：高校统一认证自动通过（平台仅校验签名与有效期）
o兜底：University Admin 人工核验队列（仅当未接入 SSO）
通过后解锁
o高校板块入口（仅本校）、校级共学社区可用、校内群/校内资源专区可见

认证项B：志愿者讲师认证（Volunteer Teacher）
触发：申请进入“高校→志愿者协会板块/匹配池”前置。
前置条件：必须已通过高校学生认证（University Student）。
提交字段（建议）
o资质材料：培训证明/志愿者证书/协会要求材料（图片/PDF）
o服务偏好：可用时间槽（建议必填）、沟通方式偏好（文字/语音/视频）
o标签要求：有效标签 ≥ 5（默认，可配置），包含主标签+对象标签；不通过则不允许提交
o承诺与协议：站内沟通与未成年人保护条款确认（必选）
审核主体：University Volunteer Association Admin（本校高校志愿者协会账号）
通过后解锁
o进入匹配池、可接服务单/咨询、可参与专项任务、可在校内规则域进行积分↔时长兑换

认证项C：普通用户基础认证（General Student / 普通用户补充学校信息）
触发：获得更高配额、提升信任等级、申请通话能力门槛降低等（产品可配置）。
前置条件：无。
提交字段（建议｜最小化采集）
o所在学校：学校名称/地区（必填）
o基础证明：在读证明/学生证/学校盖章材料（图片/PDF，至少1项）
o补充信息：年级段（可选，用于安全策略与匹配）
审核主体（过渡期）
o早期：Platform Super Admin 审核
o成熟后：入驻学校/专项援助学校管理方审核（按用户归属学校路由）
通过后解锁（示例）
o提升悬赏额度/匹配次数；语音能力更易开放（仍受风控评分）

认证项D：专项援助学生认证（Special Aid Student）
触发：开启“专项援助模式”（更严格默认安全 + 更明确对接范围）。
前置条件：无（但通常与普通用户基础认证互补）。
提交/导入方式
o批量：由 Special Aid School Admin 批次导入名单并审核（优先）
o单个：学生自主提交 → 进入对应批次审核（可选）
字段（建议）
o批次/班级/学生标识、基础证明、监护/班主任联系方式（按合规最小化，可配置是否收集）
审核主体：Special Aid School Admin
通过后解锁
o专项援助模式（匹配优先志愿者讲师池、通话门槛更高、对接时间窗可控）
6.1 账号与画像（Account & Profile）
注册/登录：手机号/邮箱/第三方（可选）
组织账号体系（修订要点）
o志愿者协会总号：协会体系顶层账号（全站），负责总公告/全体任务/协会治理
o高校账号（University Admin）：绑定 school_id，仅治理本校“校级共学社区”
o高校账号（University Admin）：绑定 school_id，仅治理本校“校级共学社区”
o高校志愿者协会账号（University Volunteer Association Admin）：绑定 school_id，仅治理本校“志愿者协会板块”，并管理志愿者讲师与校内兑换机制
o专项援助学校管理账号（Special Aid School Admin）：绑定 aid_school_id，负责专项援助学生认证与批次管理
o组织账号必须具备可审计的授权链路；高校志愿者协会账号的开通需协会总号审核通过
组织账号注册与审核（补充｜MVP必须）
o注册时允许选择账号类型：普通用户（user）/ 组织账号申请（org_admin_applicant）。组织账号申请包括：高校账号（university_admin）、高校志愿者协会账号（university_association_admin）、专项援助学校管理账号（aid_school_admin）。
o组织账号申请提交后：账号已进入数据库，但 onboarding_status=pending，登录后只能访问“审核中”页面与公共浏览能力；不可进入高校板块/管理端/需要组织域权限的功能。
o审核通过：由对应治理主体授予 AdminRole（见 9/15.6），并把 onboarding_status 更新为 approved；审核拒绝则为 rejected（可补交材料再次申请）。
o审核主体：高校志愿者协会/专项援助学校的入驻申请由协会总号审核（3.3/3.4/R2）；高校账号的开通默认由平台开通（3.4）。
o数据落库与可见性（必须｜修复“总号里没有入驻申请、只有前端假数据”的问题）
  - 所有入驻/组织账号申请必须落库为 OnboardingRequest（含申请类型、目标组织信息、联系人、材料、状态、审核意见、审核人）
  - Volunteer Association HQ 控制台的“高校协会入驻申请”列表必须来自后端 API（同一个数据源），不得使用前端临时假数据顶替
  - 申请状态变更（pending→approved/rejected）必须即时反映到申请人“审核页”与 HQ 列表中，并可追溯审计日志
o能力边界：管理员不是学生账号，不参与积分/匹配/服务单等学生侧交易闭环；但可浏览公共模块（问答/社区/知识库）以及其组织域治理后台。
个人资料：昵称、头像、地区、语言/方言、个人介绍
标签体系（分层要求） 
o选择成为讲师/志愿者（供给侧）：必须填写若干个有效标签（默认：≥5，可配置），包括但不限于： 
主题/学科/方向标签（至少1个主标签）
擅长人群/年级段/对象（至少1个）
沟通方式偏好（文字/语音/视频）
可用时间槽（建议必填）
o有效性校验（MVP建议）：不能全部选择“其他/随便”；必须覆盖“主标签+对象标签”；否则不可完成讲师上架/不可进入匹配池。
时间槽：可用时段（讲师/高校用户建议必填）
隐私：陌生人私聊/通话开关、可见性、黑名单
6.2 社交关系（Social Graph）
关注/粉丝/好友（好友可解锁更高沟通权限）
群聊：公共群/私密群/高校群（需高校认证）
动态互动：点赞、评论、收藏、转发
表情包/贴纸：内置 + 积分兑换（可选）
6.3 IM 与实时沟通（IM + RTC，平台核心｜演示必须真实落地）
私聊：文字/图片/文件/表情包（MVP 可先做文字）；会话列表、会话内消息列表、发送消息必须落库并走后端 API。
账号隔离（必须）：任何会话/消息读写必须校验“当前用户是会话参与者”，否则 403；不得出现“所有账号看到同一套会话/同一套自动回复示例”的情况。
语音/视频/电话：MVP 可仅保留入口与权限门槛；如启用则必须记录最小化业务层 call session（媒体可走 RTC/PaaS）。
安全：拉黑、举报、敏感内容提示、陌生人限频；专项援助学生默认更严格。
6.4 匹配系统（Matching Engine）
快速匹配：选择标签 + 方式（文字/语音/视频）+ 时间（立即/预约）→ 推荐Top N
候选池范围（必须）：匹配候选默认来自“全站所有高校的志愿者讲师池”（in_pool=true 且讲师认证有效）；高校志愿者协会的讲师管理仅能控制“本校讲师是否在匹配池”，不得将匹配限制为“只能看到本校讲师”。
标签采集策略（与角色协同） 
o需求侧标签可缺省：普通用户不要求在个人主页配置标签；但每次发起匹配时需选择至少1个“需求标签”（会话级标签）以便匹配与后续推荐优化。
o供给侧标签强约束：讲师/志愿者必须具备有效标签与可用时间槽，才可进入匹配池并被推荐。
排序要素：标签相似度（高权重）+ 时间重叠（硬门槛）+ 质量分（履约/评价）- 风险惩罚
解释性推荐：展示“为什么推荐TA”（增强信任）
前端展示规范：匹配结果/徽标/标签统一展示中文名称，不直接暴露内部 tag_id（例如 biology/politics/music/text/now 等仅作为内部枚举）。
冷启动：新讲师曝光扶持，但更严风控策略（陌生人通话、外链、引导站外等）
6.5 悬赏问答（Q&A Market）
发问：标题、描述、标签（必填）、悬赏积分、有效期、期望回应形式 
o标签规则：至少1个、建议1~3个；发布校验：未选择标签不可发布（用于检索、分发与沉淀知识库）。
回答：文字/图片/文件/语音（可选）
提问界面：必须提供独立的“提问页/提问表单”，作为问答模块的入口能力（MVP必做）。
最佳答案与悬赏结算：提问者可从回答列表中选择“最佳答案”，被选中的回答者获得悬赏积分；未采纳超时则按规则自动结算/退回（可配置）。
追问升级：从回答区一键发起 1v1 服务单（冻结积分）
防滥用：低信用/新号限制大额悬赏与高频发布；异常模式触发人工复核/降权
6.6 服务单（Service Order：预约-交付-评价-结算）
创建：选择对象/主题/时长/方式（语音/视频/文字）→ 冻结积分
预约：双方确认时间与方式
交付：IM/通话发生；必要时记录最小化审计信息（用于纠纷/风控）
评价：双方评价（守时、态度、专业度、是否有帮助）
结算：积分结算 + 声誉更新；异常触发仲裁/回滚
6.7 积分体系（Points Economy，无现金经济引擎）
基本原则
平台不收现金，不做付费/抽佣；所有激励以积分为唯一通用媒介。
所有用户都有积分账户：Guest 起始积分较少；完成认证（学生/高校）后起始积分更多（或提升积分获取倍率）。
积分价值统一基准：平台提供统一的积分基准与兑换档位，尽量避免不同场景“同积分不同含义”的争议。
6.7.1 积分获取（示例）
问答被采纳、优质回答高赞
完成服务单（按时长与评价）
知识库贡献（审核通过）
高校板块贡献（活动/培训笔记/资源共建，由校规配置）
6.7.2 积分消耗
悬赏提问（悬赏为积分）
预约1v1服务单（按时长/难度冻结并结算积分）
高级匹配筛选（更细标签/优先推荐）
贴纸/表情包兑换（可选）
6.7.3 积分兑换志愿时（按比例，可配置｜校内规则域）
兑换对象：仅 Volunteer Teacher（志愿者讲师）可申请将积分按比例兑换为志愿时；兑换比例与兑换上限由“本校高校志愿者协会账号”配置（平台提供统一基准建议与风控底线）。
兑换条件（建议MVP） 
o已完成供给侧认证（Volunteer Teacher）
o信用分/声誉达标，且近一段时间无严重投诉/处罚
o兑换存在周期上限（如每周/每月上限）与冷却期（防刷）
兑换去向 
o可进入“学校认可”导出队列（是否计入校内系统由本校规则决定）
o兑换记录必须可审计、可回滚（发现作弊时撤销兑换）

6.7.4 积分商城（两级商城）
个人中心商城（全站）：入口为“我的-积分-积分商城”，兑换勋章、称号、装扮类与公益小奖励（统一标准）。
校内协会商城（本校）：位于“高校 → 志愿者协会板块”，由高校志愿者协会账号配置兑换比例、上架校内奖励项与校内权益；遵循平台统一风控底线与审计要求。

6.7.5 特殊活动与志愿时长（协会可直发）
普通活动积分：按统一标准产出积分（如完成服务单、被采纳最佳答案等）。
专项活动时长：由高校志愿者协会发布的专项任务/紧急对接，可直接以“志愿者时长”结算（不必经过积分兑换），并进入审计与学校认可导出队列（是否计入由校规决定）。

6.7.6 志愿时长结算与审计（必须可追溯、可回滚）
审计对象
时长发放（VolunteerHourGrant）：来源=专项任务/兑换/人工补发/回滚
积分兑换（VolunteerHourRedemption）：积分扣减与时长增加必须形成一一对应关系（同一事务/可回滚）
关键字段（建议）
id、organization_id（高校协会）、user_id、source_type、source_id（task_id / redemption_id / admin_action_id）
hours_granted、points_used（如有）、ratio_used、rule_set_version
status（pending/approved/rejected/rolled_back）、approved_by、approved_at、rejected_reason
evidence_refs（附件/证明）、audit_log_ref（审计日志引用）
回滚规则
发现作弊/违规/材料造假：允许回滚时长与积分，并对账号施加风控惩罚（降权/下架/封禁）
回滚必须记录原因与操作人，并保持对外可解释口径（仅显示必要信息）

6.7.7 校内协会商城（组织域商品与兑换）
商品类型（示例）
权益类：校内协会优先推荐、证书/徽章（校内）、培训名额（如有）
实物/周边：统一公益周边（如组织允许）
上架与兑换规则
上架权：仅高校志愿者协会账号；商品必须绑定 organization_id
兑换口径：统一用积分结算；如兑换为志愿时长则走“兑换规则配置 + 审计”链路
库存与有效期：必须可配置；兑换记录必须可导出与可审计

6.7.8 兑换规则配置（高校志愿者协会账号可配置项）
兑换比例：points_per_hour（推荐）或 hour_per_points（二选一口径）
门槛：最低信用/评分、近N天无严重投诉、最小服务完成量（可选）
上限：每周/每月最大可兑换时长、冷却期、单次最大兑换量
复核策略：自动通过阈值/人工复核条件/异常检测阈值（如短期高频兑换）
审计：规则变更需保留历史版本并在结算记录中引用版本号
6.8 公共社区（Public Community）
动态广场：图文（MVP），短视频/直播（高风险后置）
话题页：按标签聚合
公示栏（同步展示）：展示平台级公告/规则变更/公示信息，以及学校/协会发布的可公开公告摘要（支持置顶与可追溯版本）。
共学房间（自愿陪伴，不做监督）：自习房/树洞房/答疑房（轻量功能）

6.8.x 社区发帖（必须落地）
目标：允许用户在公共社区发布“具体信息”并形成可浏览的信息流；演示环境必须落库并通过后端 API 获取（不得使用 localStorage 假数据冒充真实业务）。
发布内容（MVP建议）
内容：纯文本（必填，≥5字）
图片：可选（原型可只展示文件名/占位）
标签：可选（最多5个，便于话题聚合）
发布流程
社区页顶部“发帖框”输入内容 → 点击发布 → 新帖子出现在信息流顶部
发布后：可点赞、评论数占位、分享占位（后续接IM/转发）
数据与存储（演示必须）
帖子必须包含作者归属：author_id + author_snapshot（name/avatar/role 可做快照），不得写死“我”或固定示例作者。
任何用户发布的帖子在社区信息流中必须可区分作者；不同账号切换后不应出现“发帖者都变成同一个我”的情况。
展示时间：可用本地格式化，但 created_at 必须来自后端存储时间。

6.8.1 公告体系分层（谁能发、发到哪）
公告类型
平台公告（Platform Announcement）：发布主体=Platform Super Admin；默认进入“全站公示栏”，可置顶。
协会总号公告（HQ Announcement）：发布主体=Volunteer Association HQ；默认进入“全站公示栏”，可置顶。
高校公告（University Announcement）：发布主体=University Admin；可发布到“校级共学社区可见人群”或“本校已认证讲师人群”；可选同步全站公示栏（需配置开关/白名单策略）。
高校协会公告（University Association Announcement）：发布主体=University Volunteer Association Admin；默认仅“本校已认证讲师 + 本校协会管理人员”可见；可选同步全站公示栏。
专项援助学校公告（Aid School Announcement）：发布主体=Special Aid School Admin；默认仅专项援助学校域可见；通常不进入全站公示栏（如需对外公告，应走平台/协会总号渠道）。
公告字段（建议）
id、title、content、scope（public/campus/aid）、audience（可见人群）、organization_id（可选）、pinned、valid_from/valid_to、version、created_by、created_at
规则
对外公告必须模板化与可追溯版本；修改生成新版本并保留旧版本引用
同步到全站公示栏必须满足反引流规则与敏感信息校验

audience（可见人群）建议枚举
public_all：全站可见（进入全站公示栏）
campus_all：本校高校板块可见（校级共学社区人群）
association_teachers_only：仅本校已认证讲师可见（高校志愿者协会板块核心人群）
aid_school_only：仅专项援助学校域可见

组织化约束（必须满足）
“北京大学志愿者协会发布的校内公告”默认 audience=association_teachers_only：仅对“北京大学志愿者协会已认证讲师”可见；同时本校治理账号（高校账号/高校志愿者协会账号）与平台治理账号（协会总号/超级管理员）具备审计可见权限，不对本校全部高校学生开放。
高校账号可发布面向本校已认证讲师的公告（audience=association_teachers_only），作为该高校板块最高管理层，且该公告在“志愿者协会板块”公告列表中可见（带来源标识：高校账号）。

6.8.2 公示栏聚合与排序（展示规则）
聚合来源（按可见性过滤）
public：平台公告、协会总号公告、高校/高校协会选择同步的公告
campus：进入高校板块后展示本校公告摘要（高校账号/高校协会账号）
排序
置顶优先；同置顶按发布时间倒序；非置顶按发布时间倒序
交互
摘要列表 → 点击弹窗/详情页；支持“来源标识”（平台/协会总号/高校/高校协会）
6.9 知识库共建（Knowledge Base）
上传：笔记、教辅、经验帖、模板（支持图片/PDF/Markdown）
分类：学科/年级/主题/难度/标签
检索：标签 + 全文检索
检索：标签 + 全文检索
审核：平台底线审核 + 学校节点精选（本校资源专区）
版权：上传声明、侵权投诉、重复内容检测

7. 高校板块（按本校隔离｜二级分区治理）并与全局协同
说明：高校板块以“本校隔离”为主：默认仅“本校高校学生”及高校相关角色进入本校域（University Student / Volunteer Teacher / University Admin / University Volunteer Association Admin）；Platform Super Admin 与 Volunteer Association HQ 可跨校进入“已认证/已入驻”的高校板块用于审计与抽检。进入后分为两个板块：
志愿者协会板块：需通过高校志愿者协会认证（Volunteer Teacher 或协会认证通过的高校学生），由 University Volunteer Association Admin 治理
校级共学社区板块：所有本校高校学生可使用，由 University Admin 治理
高校板块首页（入口页）
模块入口：导航“高校” → 进入本校高校主页
二选一分区卡片：
o志愿者协会：显示认证状态与入口按钮；未认证提示“申请志愿者讲师/协会认证”
o校级共学社区：直接进入本校社区信息流与资源专区

7.1 志愿者协会板块（本校｜强治理、强审计）
核心能力
志愿者讲师审核与管理：独立的审核界面 + 管理界面 + 讲师实时数据（服务单、评价、投诉、响应时长等）
协会公告：可发布校内公告（默认仅本校已认证讲师可见）；可选同步到“全站社区公示栏”（对外公示，面向全体用户）
专项任务：发布面向本校志愿者的专项任务/紧急对接；专项任务可直接结算志愿者时长
校内兑换机制：配置积分兑换志愿时比例、周期上限与风控门槛；提供“校内协会商城”
校内风控协作：对异常志愿者/活动发起处置建议并上报协会总号/平台风控

7.1.1 讲师认证审核页（独立审核界面）
列表筛选：状态（待审/通过/驳回）、标签方向、风险标记、申请时间
材料查看：培训/资质证明、补充说明、历史处分/投诉（如有）
校验规则：标签数量与结构、时间槽完整性、违规项（外链/营销历史）命中
审核动作：通过、驳回（原因模板+可编辑）、拉黑/加入观察名单、请求补充材料

7.1.2 讲师管理页（独立管理界面 + 实时数据）
讲师列表字段：姓名/昵称、认证状态、主标签、近期活跃、响应时长、服务完成率、评分、投诉次数、风险等级、是否在匹配池
管理动作：下架/恢复、限制通话、限制私聊、标记风险、发起复核（上报协会总号/平台风控）
数据看板（讲师维度）：日/周对接数、首响时长、好评率、复约率、投诉率、异常模式提示

7.1.3 协会公告（校内公告 + 可选全站同步）
发布范围：campus（仅本校高校板块可见）/ public（同步全站公示栏）
发布控制：置顶、有效期、可追溯版本（修改需生成新版本）
内容规范：招募/合作信息模板化；禁止站外引流与敏感信息收集

7.1.4 专项任务与活动（本校志愿者）
说明：专项任务面向“本校志愿者讲师”或“协会认证通过的本校学生”。
任务类型：紧急任务（优先展示）/ 专项任务（长期计划）
字段：标题、目标说明、参与条件、时间窗、人数上限、证据要求、时长奖励、发布人、状态
结算：完成后提交证据 → 协会审核通过 → 直接发放志愿者时长（进入审计与导出队列）
协会总号治理：协会总号可抽检/审核高校协会活动与任务执行情况（不直接代替本校发布）

7.1.5 校内协会商城与兑换规则（组织域配置）
兑换比例：points_per_hour / hour_per_points（单选口径，避免双口径）
门槛与上限：最低信用/评分/无投诉周期、每周/每月兑换上限、冷却期
兑换申请：可配置为“自动通过”或“人工复核”；所有兑换产生审计记录与可回滚机制

7.1.6 数据导出与审计（协会域）
导出对象：讲师名单、任务完成与时长、兑换记录、处罚记录、异常告警
审计要求：记录规则版本、批准人、证据附件、回滚原因（见附录字段字典）

7.2 校级共学社区板块（本校｜知识分享与交流）
定位：大学内部的知识分享交流（类似现有的社区+知识库，但范围限定在本校）
核心能力
校内信息流：帖子/评论/收藏/转发，话题聚合
校内知识库专区：资料上传、精选、检索（本校可见）
校内群组：学院群/项目群/共学群
校内治理：University Admin 维护话题、帖子与秩序；仍受全站底线风控约束

7.2.1 内容类型与发布规则（校内社区）
内容类型：图文帖、经验帖、资源分享帖（可关联知识库资源）、活动/共学招募帖（模板化）
发布校验：必须选择至少1个校内话题/标签（来源于标签字典+校内扩展）；禁止站外引流
可见性：仅本校可见（默认）；可选“同步到全站社区”需高校账号审核或开启白名单策略（可选能力）

7.2.2 话题与资源治理
话题：创建/合并/停用、推荐位；避免标签碎片化
资源：上传声明、侵权投诉、重复检测；可打“本校精选”与“全站精选”（需平台复核，后置）

7.2.3 与全站社区/知识库协同
校内社区是“范围限定的社区”，全站社区是“开放广场”；默认不互通时间线
优质内容可被“同步/搬运”为全站公开内容（需审核与追溯），用于对外展示与跨校传播（后置能力）

7.3 跨校协作（保留为后续扩展）
跨校交流板块（Inter-University Hub）可作为 Phase 2+ 扩展：默认不计入学校认可，且更严格反引流策略；是否上线取决于风控成熟度与高校共建需求。

8. 匹配与推荐（Matching & Ranking）
8.1 匹配输入
需求侧：会话级需求标签（每次匹配必选至少1个）、期望方式（文字/语音/视频）、时间（立即/预约）
供给侧：讲师有效标签（必填）、可用时间槽（建议必填）、服务偏好
质量与安全：履约率、好评率、投诉率、风险等级
8.2 排序与解释
综合评分 = 标签相似度（高权重） + 时间匹配（硬门槛） + 质量分（履约/评价） - 风险惩罚
解释示例：“你选择了 #英语写作 #方法论 #晚间可聊，TA与这些标签高度匹配且最近响应快。”
8.3 问答分发与检索（依赖提问标签）
悬赏问题必须带标签，用于： 
o问题池检索与分类
o推荐给匹配标签的讲师/志愿者
o进入知识库沉淀与复用
问题推荐排序参考：标签匹配度 + 回答者质量分 + 活跃度 + 反作弊/风控惩罚
8. 核心流程泳道图（Mermaid）
8.1 流程A：快速匹配 → 1v1 服务单 → 评价结算（含风控）
flowchart LR
  subgraph U[需求用户（游客/普通学生/高校学生/专项援助学生）]
    U1[选择标签/方式/时间\\\\n(立即 or 预约)]
    U2[发起匹配请求]
    U3[选择候选并发起会话/服务单]
    U4[聊天/语音/视频]
    U5[提交评价]
  end

  subgraph V[供给侧（志愿者讲师｜必要时可扩展认证高校学生）]
    V1[接收匹配/接单提醒]
    V2[接受/拒绝]
    V3[交付：聊天/语音/视频]
    V4[提交评价/反馈]
  end

  subgraph P[平台（匹配/风控/结算）]
    P1[匹配计算\\\\n(标签相似度+时间槽+质量分)]
    P2[风控检查\\\\n(年龄/陌生人/频控/风险分)]
    P3[创建会话&服务单\\\\n(冻结积分)]
    P4[通话能力鉴权\\\\n(是否允许语音/视频)]
    P5[结算积分\\\\n(采信评价/仲裁规则)]
    P6[更新信用/声誉]
  end

  subgraph S[组织节点（可选）]
    S1[如计入认可：校规校验\\\\n(时长/评价/无投诉)]
  end

  U1 --> U2 --> P1 --> P2
  P2 -->|通过| P3 --> U3
  P2 -->|拦截/降级| U3
  U3 --> V1 --> V2
  V2 -->|接受| P4 --> U4 --> V3 --> U5 --> P5 --> P6
  V3 --> V4 --> P5
  P5 --> S1

8.2 流程B：悬赏问答 → 采纳 → 追问升级 1v1
flowchart TB
  subgraph U[提问用户]
    U1[发布问题\\n(消耗/冻结积分, 受配额限制)]
    U2[查看回答]
    U3[采纳/追加悬赏\\n或发起追问]
    U4[可选：升级1v1服务单]
  end

  subgraph A[回答者（志愿者讲师/高校学生/普通用户）]
    A1[浏览问题池]
    A2[提交回答]
    A3[继续追问答疑]
  end

  subgraph P[平台（内容/反作弊/结算）]
    P1[内容审核&反灌水\\n(低质折叠/重复合并)]
    P2[积分冻结]
    P3[采纳结算\\n(积分转移)]
    P4[升级服务单\\n(冻结积分+预约)]
  end

  U1 --> P2 --> P1 --> A1 --> A2 --> P1 --> U2 --> U3 --> P3
  U3 -->|追问升级| U4 --> P4 --> A3

8.3 流程C：学校认可导出/回传（可选）
flowchart TB
  subgraph V[志愿者讲师（Volunteer Teacher）]
    V1[完成服务单]
    V2[满足校规条件\\n(时长/评价/无投诉)]
  end

  subgraph P[平台（认可引擎）]
    P1[聚合服务记录\\n&审计日志]
    P2[生成RecognitionRecord]
    P3[按校导出/接口\\n(数据隔离)]
  end

  subgraph S[组织节点（高校/协会/专项援助学校）]
    S1[配置规则\\n(换算/阈值/复核)]
    S2[抽检/复核]
    S3[导出/回传校内系统]
  end

  S1 --> P1
  V1 --> P1 --> P2 --> S2 --> P3 --> S3
  V2 --> P1


9. 数据模型（简化ER草案｜按组织与多租户扩展）
User（账号）
Profile（画像/隐私/时间槽）
Verification（高校学生认证/志愿者讲师认证/普通用户基础认证/专项援助学生认证）
Organization（组织）：type = association_hq / university / university_association / aid_school
AdminRole（管理角色）：绑定 user_id + organization_id + role_code（不同管理端权限域）
Tag（标签字典：主题/对象/方式等）/ UserTag（用户标签：供给侧必填）
MatchRequest / MatchResult（匹配请求与结果：需求侧为会话级标签）
Conversation / Message（会话与消息）
CallSession（语音/视频通话记录）
Question / Answer（悬赏问答） 
oQuestionTag（必填关联）：question_id ↔ tag_id（发布校验：至少1个）
ServiceOrder（服务单：预约/完成/评价/结算/仲裁）
PointWallet / PointTxn（积分钱包与流水：冻结/解冻/转账）
AssociationRuleSet（协会规则）：兑换比例/上限/门槛/审计策略（按 organization_id）
AssociationMallItem（校内协会商城）：按 organization_id 上架与兑换
VolunteerHourGrant（时长发放）：来源=专项任务/兑换/人工补发，按 organization_id 审计
Announcement（公告）：type=platform/hq/university/university_association/aid_school + scope=public/campus/aid；audience=public_all/campus_all/association_teachers_only/aid_school_only；必须包含 created_by + created_by_snapshot（最小：username/full_name），用于公示栏“来源标识/发布方”展示
AssociationTask（专项任务/紧急任务）：按 organization_id 发布、核验与结算
AssociationOnboardingRequest（高校协会入驻申请）：由协会总号审核通过后开通组织域
AssociationActivityReview（高校协会活动审核/监控）：由协会总号抽检/审核与留痕
SystemEvent（系统事件/实时活动）：type=daily/urgent，用于超级管理员监控与告警
CommunityPost / Comment / Like / Favorite（公共社区）
CampusPost（校级共学社区帖子：school_id 强绑定）
KnowledgeAsset / ReviewQueue（资源与审核队列）
Report / ModerationCase（举报与处置）
RecognitionRecord（学校认可记录：导出状态/回传状态，可引用兑换记录与服务单记录）

10. 技术架构建议（高层）
前端：Web 优先（PC+H5），后续小程序/原生App
后端：业务中台（用户、认证、匹配、积分、问答、社区、知识库、风控、学校节点）
IM/RTC：接入成熟SDK或PaaS（降低弱网与运维风险），业务逻辑自研
搜索：全文检索（后续可扩展语义检索用于更好匹配）
多租户：school_id 作为隔离域；配置与数据导出按校分区
日志审计：关键行为留痕（认证、结算、处置、导出），满足复核与合规需求

11. 安全、风控与合规（底线能力）
默认安全（Safe-by-default）：陌生人交互限制、深夜通话限制、外链与站外引导限制
内容治理：文本/图片/音视频敏感内容识别与处置（提示/折叠/下架/封禁）
举报/申诉：SOP、分级处置、时效要求、可审计
未成年人保护：更严格的隐私默认值与陌生人沟通门槛；敏感信息采集走最小化与必要性原则
证据保全：仅在纠纷/安全事件时触发，严格权限与留存周期控制
高校板块专项：招募/合作信息模板化 + 管理员抽检入口 + 强反引流策略

12. MVP与迭代路线图（按治理分层落地）
原则：先把“对接+社交+积分闭环”做强，再扩展高风险内容形态（短视频/直播）。
Phase 1（MVP：跑通闭环 + 高校板块基础上线）
账号/画像/标签/隐私
认证中心（独立认证项）：高校学生认证、志愿者讲师认证、普通用户基础认证（过渡期平台审核）、专项援助学生认证（专项援助学校管理方）
高校板块 v1：校级共学社区（本校）+ 志愿者协会板块（本校）
志愿者讲师审核：下放至高校志愿者协会账号；协会总号负责高校协会入驻审核
快速匹配 + 1v1私聊（文字/图片/表情）
悬赏问答（提问/回答/采纳/积分）
语音通话（优先音频；视频灰度）
公共社区（发帖/评论/收藏）
知识库（上传/审核/检索）
公示栏：对接平台公告/协会总号公告/高校协会可选同步公告
风控：举报/黑名单/限频/内容审核
Phase 2（增强：服务单体系 + 高校协作完整）
服务单（预约/确认/完成/评价/结算）
视频通话扩大开放（随风控分层）
高校协会专项任务体系完善：任务→时长→审计→学校认可导出
校内/校际活动系统（报名/群/资料）：活动审核职责归协会总号/高校协会（按类型）
高校管理端完善：校级共学社区治理、校内资源精选与可导出审计
跨校交流板块（可选上线）：严格反引流与默认不计入学校认可
Phase 3（规模化：学校认可闭环 + 高级匹配）
学校认可闭环（RecognitionRecord 导出/接口）
高级匹配（语义+标签融合、解释性更强）
PoS增强仅用于认可场景（防刷，不做学习监督）
短视频/直播（强审核体系成熟后再上）

13. 风险清单与应对
1.未成年人风险/骚扰 → 默认严格隐私与陌生人门槛、强举报处置、深夜限制
2.跨校板块营销引流 → 外链限制、招募模板化、反广告策略、管理员抽检
3.积分刷单/套利 → 冻结结算、异常检测、仲裁回滚、信用分联动降权
4.多校规则差异 → 平台统一底线 + 模板化配置；联合活动需双方管理员确认
5.资料版权风险 → 上传声明、侵权投诉、重复检测与快速下架

14. 待定决策（如需落地必须尽快定）
1.高校学生认证的具体方式（校内SSO/统一认证/人工核验）与“普通用户基础认证”的过渡期审核方案
2.跨校交流板块是否上线、边界与默认规则（建议默认不计入学校认可）
3.语音/视频开放策略：分角色策略 vs 风控评分动态开通（建议动态+可配置）
4.校内/跨校资源引用规范与许可协议模板（建议必须）

附录：模块清单Checklist（研发开工用）
[ ] 账号体系（管理层：超级管理员/协会总号/高校账号/高校协会账号/专项援助学校管理方；用户层：游客/普通学生/高校学生/志愿者讲师/专项援助学生）
[ ] 标签体系 + 时间槽
[ ] 匹配推荐 + 可解释
[ ] IM私聊 + 群聊 + 通话（音频优先）
[ ] 悬赏问答
[ ] 服务单（预约-完成-评价-结算-仲裁）
[ ] 积分经济（钱包/流水/冻结）
[ ] 积分商城（全站个人中心商城 + 校内协会商城）
[ ] 成就系统（徽章/等级/里程碑）
[ ] 公共社区（帖/评/赞/藏）
[ ] 知识库（上传/审核/检索/精选）
[ ] 高校板块（本校：校级共学社区 + 志愿者协会板块；跨校板块可选）
[ ] 管理端分层（协会总号/高校账号/高校协会账号/专项援助学校管理方）
[ ] 标签字典后台（超级管理员可编辑标签）
[ ] 全站风控与内容安全（举报/处置/审计）

附录A：页面与字段字典（MVP）
A1 认证申请列表（VerificationRequest）
通用字段：id、申请类型、组织域（可选）、申请人、学校/组织、状态、风险等级、提交时间、审核人、审核时间、驳回原因、材料附件数
动作：通过/驳回/请求补充/拉黑/加入观察；所有动作写入审计日志

A2 讲师列表（VolunteerTeacher）
字段：user_id、姓名/昵称、学校（school_id）、主标签、标签数、可用时间槽摘要、状态（在池/下架/冻结）、评分、服务完成率、首响时长、投诉次数、风险等级、最近活跃
动作：下架/恢复、限制通话/私聊、标记风险、导出

A3 公告列表（Announcement）
字段：id、标题、发布主体类型、可见范围（public/campus/aid）、组织域、置顶、有效期、版本、发布时间、状态（生效/过期/撤回）
动作：置顶/取消置顶、发布新版本、撤回、同步开关（高校/高校协会）

A4 专项任务列表（AssociationTask）
字段：id、类型（紧急/专项）、标题、组织域、时间窗、参与条件、证据要求、时长奖励、状态、创建人、创建时间、完成数、异常标记
动作：发布/结束、查看参与者、审核证据、结算时长、导出

A5 兑换规则（AssociationRuleSet）
字段：organization_id、ratio、门槛（信用/投诉/评分/完成量）、上限（周/月/单次）、冷却期、复核策略、版本号、更新时间、更新人
动作：新建版本/回滚版本/启停规则

A6 兑换记录与时长发放（VolunteerHourRedemption / VolunteerHourGrant）
字段：id、organization_id、user_id、来源（任务/兑换/补发/回滚）、points_used、hours_granted、ratio_used、rule_set_version、状态、审核人、审核时间、证据附件、回滚原因（如有）
动作：审核通过/驳回、回滚（权限受控）、导出

A7 协会入驻申请（AssociationOnboardingRequest）
字段：申请高校、拟开通组织域、联系人、材料附件、状态、风险标记、审核人、审核时间、驳回原因
动作：通过/驳回、开通组织域（由平台执行）、列入观察

A8 高校协会活动审核与监控（AssociationActivityReview）
字段：高校、活动名称、类型、影响范围、时间、负责人、风险等级、审核状态、执行进度、投诉与异常事件、抽检记录
动作：通过/驳回、抽检、要求整改、升级到平台风控

A9 实时活动（SystemEvent｜超级管理员）
字段：时间、分组（日常/紧急）、级别、来源、事件标题、详情、影响范围、处理状态、处理人、关联工单
动作：确认/升级/关闭、创建工单、发送系统通知（可选）

附录D：高校目录（跨校审计）数据口径（实现约束）
高校目录卡片以 school_id 为主键聚合（同一高校只有一张卡片）。聚合字段建议：
- school_id（如 PKU/THU）
- display_name（高校名称）
- board_enabled（是否开通高校板块）：存在 university org 或 university_association org 即为 true
- university_org_status：none/pending/active（是否存在 university 组织域与其认证状态）
- association_org_status：none/pending/active（是否存在 university_association 组织域与其认证状态）
- entrypoints：community_url / association_url（审计模式入口）
禁止事项：association_hq 不参与高校目录聚合，不得被当作 school_id。所有跨校进入默认只读（除全站底线治理接口）。

15. 后端设计与 API 契约（FastAPI｜与当前前端实现对齐）
目标：为 FastAPI 后端实现提供“可直接开工”的精确边界、数据模型、鉴权与接口契约；不改变现有产品与治理逻辑，只补齐后端落地细节。

15.1 当前前端实现约束（作为后端契约来源）
前端技术：Next.js 16 + React 19（以 Client Component 为主）。
现状：业务数据读写以本地存储为主（localStorage 封装在 lib/client-store.ts）；尚未接入真实网络 API。
后端对齐原则：后端数据模型与字段枚举优先对齐 client-store.ts 的类型定义；前端由“本地读写”逐步替换为“API 调用”。

15.2 后端职责边界（Backend Responsibility）
后端必须覆盖以下职责域（与前端页面一一对应）：
认证与会话：登录、鉴权、角色与组织域权限、跨校审计只读能力。
组织域与多租户：school_id / organization_id 维度的数据隔离、可配置规则域、跨校审计视角访问控制。
内容与审核：公告、公共社区、校内社区（校园帖子/话题）、问答、举报与处置。
积分账本与结算：积分余额以流水为准；悬赏问答采纳、服务单结算、兑换与回滚的事务一致性。
协会域运营：讲师审核/管理、专项任务、兑换规则、协会商城、志愿时长发放与审计。
系统监控事件：超级管理员“日常/紧急”事件流（SystemEvent）与处置状态。
审计与导出：关键治理动作必须可追溯（审核/结算/回滚/封禁/规则变更），按组织域导出。

不在本阶段强制纳入（可后置实现）：
RTC/IM 的底层媒体与长连接能力（可接第三方 SDK/PaaS），但后端仍需提供会话/消息/通话记录的业务 API 边界。

15.3 技术栈与模块化建议（可替换项）
推荐默认实现（可替换，但需满足同等能力）：
Web 框架：FastAPI（OpenAPI 自动生成）。
数据校验：Pydantic（请求/响应 schema）。
持久化：SQLAlchemy + Alembic（迁移）；数据库建议 PostgreSQL（或 MySQL）。
缓存/限流：Redis（可选，推荐用于限频、验证码、会话黑名单、幂等键）。
对象存储：S3/OSS（可选，用于材料/证据/资源文件）。

模块分层（建议的代码分区，不要求前端配合）：
auth（登录/鉴权/令牌）
rbac（角色/权限/作用域校验）
orgs（组织域与目录）
content（公告/社区/校内社区/问答）
verification（认证与审核）
points（账本/流水/冻结/结算）
association（讲师/任务/规则/商城/时长）
moderation（举报/处置/审计）
system_events（系统事件/告警）

15.4 API 基础规范（统一约束）
Base URL 与版本
统一前缀：/api/v1
所有时间：ISO8601（UTC），字段名统一使用 *_at。
ID：对外统一用字符串（建议 UUID）；对内可自增，但对外不可暴露推断性 ID（可通过映射/UUID 化）。

统一响应（建议）
成功响应（列表/详情均一致）：
  {
    "data": <object | array>,
    "meta": { "trace_id": "...", "page": { ... } }
  }
错误响应：
  {
    "error": {
      "code": "AUTH_REQUIRED | FORBIDDEN | VALIDATION_ERROR | NOT_FOUND | CONFLICT | RATE_LIMITED | INTERNAL",
      "message": "面向前端的可读文案",
      "details": <object | null>
    },
    "meta": { "trace_id": "..." }
  }

分页/排序/过滤（统一一套，避免接口各自为政）
列表接口统一使用 cursor 分页（推荐）或 offset/limit（二选一，本文档默认 cursor）：
  - cursor：page_cursor（上一页末尾游标） + page_size（默认 20，最大 100）
  - 返回 meta.page：{ "next_cursor": "...", "has_more": true }
排序统一字段：sort_by、sort_order（asc/desc）
过滤字段：按资源定义 query 参数（例如 school_id、status、scope、audience）

幂等与并发
涉及余额/结算/回滚的写接口必须支持幂等键：Idempotency-Key 头（同一用户在同一 key 下重复请求必须返回同一结果）。
更新接口使用乐观锁：version 字段或 If-Match（ETag）二选一。

15.5 鉴权与授权（与角色体系一致）
会话与令牌
默认方案：OAuth2 Password Flow + Bearer JWT（FastAPI 官方安全教程范式），密码必须安全哈希存储（推荐 Argon2）；JWT 不加密但必须签名且设置过期时间。参考 FastAPI 安全文档（OAuth2 + JWT）：
  https://fastapi.tiangolo.com/tutorial/security/oauth2-jwt/
若后续接入高校统一认证：在 /auth/ 下预留 SSO/OIDC 扩展（不改变前端角色语义）。
建议接口：
  - POST /api/v1/auth/token（OAuth2PasswordRequestForm：username/password/form-data；返回 access_token）
  - POST /api/v1/auth/logout（将 token 加入黑名单或刷新 token 失效，取决于实现）
  - GET /api/v1/auth/me（返回当前用户与其角色/组织域）

权限模型（必须满足的约束）
用户角色（UserRole）：与 3.1/4.1 一致，作为全局 role 的第一层判断。
组织域管理权限（AdminRole）：user_id + organization_id + role_code（university_admin / university_association_admin / aid_school_admin / association_hq / superadmin）
最小化 scopes（可选）：用于更细粒度权限在 OpenAPI 中可见（FastAPI OAuth2 scopes 参考）：
  https://fastapi.tiangolo.com/advanced/security/oauth2-scopes/

多租户隔离规则（必须强制执行）
school_id 域（高校板块）：CampusTopic/CampusPost/高校公告等必须携带 school_id，且只能被“同校域”用户读写；例外：
  - superadmin 与 association_hq：允许跨校只读审计进入（不允许写操作，除非是“全站底线处置”接口）。
organization_id 域（协会/援助学校）：协会任务、讲师审核、兑换规则、协会商城、时长发放等必须绑定 organization_id；除 superadmin/association_hq 审计外，不得跨组织域读取与变更。

15.6 后端实体映射（以 client-store.ts 为源）
说明：以下为必须落库的核心实体（字段名可 snake_case，但对外响应需与前端契约一致或提供稳定映射）。

组织与用户
Organization：对应 client-store.ts 的 OrganizationEntry（type=university/university_association/aid_school）；字段：id、type、display_name、school_id、aid_school_id、certified、created_at。
User：包含 role、school_id（可为空）、基础资料、禁用/封禁状态；支持“用户层身份叠加”时可用 claims 表/字段扩展（见 3.4）。
UserLocalState（持久化版）：积分余额 points、认证状态 verification.*（取代前端 localStorage）。

标签与公告
Tag：对应 TagItem；字段：id、name、category、enabled、created_at、updated_at。
Announcement：对应 AnnouncementItem；字段：id、title、content、scope（public/campus/aid）、audience、school_id、organization_id（可选）、pinned、created_by、created_at、updated_at、version。

公共社区
CommunityPost：对应 CommunityPost；字段：id、author_id、content、tags（可拆 CommunityPostTag）、created_at、likes_count、comments_count、shares_count。
CommunityComment/Reaction/Favorite：前端目前仅占位，但后端应预留，以免后续破坏 API。

校内社区（高校域）
CampusTopic：对应 CampusTopic；字段：id、school_id、name、enabled、created_at。
CampusPost：对应 CampusPost；字段：id、school_id、author_id、content、topic_ids（可拆关联表）、created_at、likes_count、comments_count、pinned、visibility（visible/hidden）。

问答
QaQuestion：对应 QaQuestion；字段：id、subject、title、content、tags、reward_points、created_at、author_id、views、answers_count、solved、accepted_answer_id。
QaAnswer：对应 QaAnswer；字段：id、question_id、author_id、content、likes_count、created_at。

认证与审核
VerificationRequest：对应 VerificationRequest；字段：id、type（general_basic/university_student/volunteer_teacher/special_aid）、applicant_id、target_school_id/organization_id（按类型）、evidence_refs、note、status（pending/approved/rejected）、reviewed_by、reviewed_at、rejected_reason。
VolunteerTeacherApplication：对应 VolunteerTeacherApplication（协会域）；字段同 client-store.ts。
AidVerificationBatch / AidStudentVerificationRequest / AidSafetyConfig：对应 client-store.ts。

积分与时长
PointTxn：对应 PointTxn；字段：id、user_id、type、title、points（可正可负）、meta、created_at。
RedemptionRecord：对应 RedemptionRecord；字段：id、user_id、item_id、item_name、points_cost、created_at。
AssociationRuleSet / AssociationMallItem / VolunteerHourGrant：对应 client-store.ts；必须有 version 与审计字段。

系统事件与处置
SystemEvent：对应 SystemEvent；字段：id、group（daily/urgent）、title、detail、level、status、created_at、handled_by、handled_at。
Report / ModerationCase：用于举报/处置与全站底线治理（与 11 章一致）。

15.7 接口字典（按页面/模块分组）
说明：以下接口为“最小但可闭环”的建议；所有写接口需鉴权，且按 15.5 强制做域隔离与越权校验。

15.7.1 Auth & Users（登录与用户）
POST /api/v1/auth/token
  - 请求：OAuth2PasswordRequestForm（username/password，form-data）
  - 响应：{ access_token, token_type, expires_in, user: { id, role, school_id?, ... } }
GET /api/v1/auth/me
POST /api/v1/auth/logout
GET /api/v1/users/{id}（仅本人或管理端可见）
PATCH /api/v1/users/{id}（本人更新头像/简介/隐私开关；管理端更新封禁/禁言等）

15.7.2 Organizations（组织目录与跨校审计入口）
用于满足 5.2 “高校目录页（跨校审计）”与认证中心组织搜索：
GET /api/v1/orgs?type=university|university_association|aid_school&certified=true
GET /api/v1/orgs/{id}
POST /api/v1/orgs（仅 superadmin/hq：开通组织域）
PATCH /api/v1/orgs/{id}（仅 superadmin/hq：认证/停用）

15.7.3 Tags（标签字典）
GET /api/v1/tags
POST /api/v1/tags（仅 superadmin）
PATCH /api/v1/tags/{id}（仅 superadmin：启停/改名/改分类）

15.7.4 Announcements（公告体系）
GET /api/v1/announcements?scope=public|campus|aid&school_id=&audience=&pinned=
  - 规则：按 audience + 组织域/角色过滤；public_all 可全站读。
POST /api/v1/announcements
  - 权限：platform/hq/university_admin/university_association_admin/aid_school_admin（按 6.8.1）
PATCH /api/v1/announcements/{id}
  - 用途：置顶、版本发布（生成新版本）、撤回、同步开关（如需）

15.7.5 Public Community（公共社区）
对应 /community（发帖与信息流）
GET /api/v1/community/posts?page_cursor=&page_size=&q=&tag=&sort_by=created_at
POST /api/v1/community/posts（content≥5，tags≤5）
POST /api/v1/community/posts/{id}/like（幂等）
POST /api/v1/community/posts/{id}/favorite（幂等）
POST /api/v1/community/posts/{id}/report

15.7.6 Campus Community（校级共学社区｜按 school_id）
对应 /campus/community 与高校账号治理台
GET /api/v1/campus/{school_id}/topics
POST /api/v1/campus/{school_id}/topics（高校账号创建话题）
PATCH /api/v1/campus/{school_id}/topics/{topic_id}（启停）
GET /api/v1/campus/{school_id}/posts?page_cursor=&page_size=&q=&topic_id=&tab=recommend|hot
POST /api/v1/campus/{school_id}/posts（校内用户发布；审计用户禁止写）
PATCH /api/v1/campus/{school_id}/posts/{post_id}
  - 用途：高校账号置顶/隐藏；作者可删除或修改（按策略）
DELETE /api/v1/campus/{school_id}/posts/{post_id}

15.7.7 QA（悬赏问答与采纳结算）
对应 /qa、/qa/ask、/qa/[id]
GET /api/v1/qa/questions?page_cursor=&page_size=&q=&tag=&subject=&solved=
POST /api/v1/qa/questions
  - 行为：冻结 reward_points（写入 PointTxn：reward_out 或冻结交易）
GET /api/v1/qa/questions/{id}
POST /api/v1/qa/questions/{id}/answers
POST /api/v1/qa/questions/{id}/accept
  - 请求：{ answer_id }
  - 事务：结算悬赏（写入 PointTxn：reward_in；更新 question.solved/accepted_answer_id）

15.7.8 Verification（认证中心与审核）
对应 /verify 与各管理端审核列表
POST /api/v1/verifications/requests（用户提交认证）
GET /api/v1/verifications/requests?type=&status=&school_id=&organization_id=（管理端列表）
GET /api/v1/verifications/requests/{id}
POST /api/v1/verifications/requests/{id}/review
  - 请求：{ status: approved|rejected, rejected_reason? }
  - 权限路由：按 3.3/3.5（高校学生→university_admin；讲师→university_association_admin；专项援助→aid_school_admin；基础认证过渡期→superadmin）

15.7.9 Association Domain（高校志愿者协会域）
对应 /campus/association 与 /association/dashboard
讲师
  - GET /api/v1/association/{school_id}/teacher-applications?status=
  - POST /api/v1/association/{school_id}/teacher-applications/{id}/review
  - GET /api/v1/association/{school_id}/teachers
  - PATCH /api/v1/association/{school_id}/teachers/{user_id}（下架/恢复/风险标记）
专项任务
  - GET /api/v1/association/{school_id}/tasks?status=&type=
  - POST /api/v1/association/{school_id}/tasks
  - PATCH /api/v1/association/{school_id}/tasks/{id}
  - POST /api/v1/association/{school_id}/tasks/{id}/settle-hours（结算时长）
兑换规则与商城
  - GET /api/v1/association/{school_id}/rule-set
  - PUT /api/v1/association/{school_id}/rule-set（新版本）
  - GET /api/v1/association/{school_id}/mall/items
  - POST /api/v1/association/{school_id}/mall/items
  - PATCH /api/v1/association/{school_id}/mall/items/{id}
时长发放/回滚
  - GET /api/v1/association/{school_id}/hour-grants?status=&user_id=
  - POST /api/v1/association/{school_id}/hour-grants（补发/回滚/兑换审批）

15.7.10 Aid School Domain（专项援助学校域）
对应 /aid-school/dashboard
GET /api/v1/aid/{aid_school_id}/batches
POST /api/v1/aid/{aid_school_id}/batches（创建批次）
POST /api/v1/aid/{aid_school_id}/batches/{id}/import（名单导入：文件/JSON 二选一）
GET /api/v1/aid/{aid_school_id}/requests?batch_id=&status=
POST /api/v1/aid/{aid_school_id}/requests/{id}/review
GET /api/v1/aid/{aid_school_id}/students（援助学生列表：仅当前有效援助认证）
POST /api/v1/aid/{aid_school_id}/students/{user_id}/revoke（撤销援助认证：不删除账号，不停用登录，仅解除 aid 身份）
GET /api/v1/aid/{aid_school_id}/safety-config
PUT /api/v1/aid/{aid_school_id}/safety-config

15.7.11 Admin & System Events（超级管理员）
GET /api/v1/admin/system-events?group=daily|urgent&status=
POST /api/v1/admin/system-events/{id}/ack
POST /api/v1/admin/system-events/{id}/close
GET /api/v1/admin/reports?status=&scope=
POST /api/v1/admin/moderation-cases/{id}/actions（禁言/封禁/下架/解封）

15.7.12 Match（匹配引擎业务 API）
对应 /match/help 与 /match/results（替换 localStorage 的 currentMatchRequest）
POST /api/v1/match/requests
  - 请求：{ tags: [..], channel: "text|voice|video", time_mode: "now|schedule", time_slots?: [...], note?: "" }
  - 响应：{ id }
GET /api/v1/match/requests/{id}/results?page_cursor=&page_size=
  - 响应：候选列表（全站讲师池 in_pool=true 的匹配结果，包含 explain 字段；可选同校加权但不得硬过滤）

15.7.13 Conversations（消息与会话｜演示必须落地）
对应 /messages 与 /chat/[id]
GET /api/v1/conversations
POST /api/v1/conversations（创建或复用 1v1 会话：{ peer_user_id }）
GET /api/v1/conversations/{id}/messages?page_cursor=&page_size=
POST /api/v1/conversations/{id}/messages
POST /api/v1/conversations/{id}/calls（创建通话会话：记录业务层 session，媒体走 RTC/PaaS）

15.8 关键事务与一致性规则（必须写入实现验收）
积分账本（Points Ledger）
余额不直接写字段作为真相：以 PointTxn 聚合为准（可缓存余额，但必须可由流水重建）。
悬赏问答：
  - 发问时：reward_points 冻结/扣减（PointTxn: reward_out 或 freeze）
  - 采纳时：对回答者入账（PointTxn: reward_in），并更新 question.solved 与 accepted_answer_id
  - 全流程必须在单事务中完成；失败则回滚。
幂等：accept/settle/redeem 等关键接口必须支持 Idempotency-Key，防止前端重试造成双扣/双发。

志愿时长（Volunteer Hours）
发放/兑换/回滚均写入 VolunteerHourGrant，必须包含：source_type/source_id、rule_set_version、approved_by、evidence_refs、状态机。
回滚必须可追溯：写入新 grant 记录（source_type=rollback）并关联原记录。

15.9 环境与配置（dev/test/prod，禁止事项明确）
环境变量（建议）
APP_ENV=dev|test|prod
DATABASE_URL、REDIS_URL（可选）、JWT_SECRET、JWT_ALGORITHM、JWT_EXPIRE_MINUTES
CORS_ALLOW_ORIGINS（dev 可放宽，prod 必须白名单）
STORAGE_PROVIDER（local/s3/oss，可选）、STORAGE_BUCKET、STORAGE_PUBLIC_BASE_URL
RATE_LIMIT_*（限频阈值）

禁止事项
prod 环境禁止使用任何 mock 数据种子；仅允许 test 环境使用测试种子与假数据。
不得在日志中打印 token、密码、材料原文等敏感信息；审计日志只记录必要元数据。

15.10 测试与验收（必须覆盖的用例）
接口测试框架建议：pytest + httpx（FastAPI TestClient/AsyncClient），覆盖：
鉴权：未登录 401、越权 403、跨校/跨组织域访问被拒绝。
多租户：同一资源在不同 school_id/org_id 下不可互读；审计角色只读不可写。
积分事务：悬赏冻结→采纳结算→回滚（异常）均一致；幂等键生效。
审核状态机：pending→approved/rejected，审核人/时间/原因写入；重复审核行为被拒绝或幂等处理。
公告可见性：public_all/campus_all/association_teachers_only/aid_school_only 的过滤正确。

验收标准（与 58-61 的产品验收一致）
任意一个前端页面（/campus/community、/qa/ask、/verify、/hq/dashboard 等）都能在本章找到：对应实体、接口、权限条件与典型错误返回。
dev/test/prod 的差异、CORS、mock 禁止事项清晰且可自动化校验。
